# üìà Thai Stock Prediction with LSTM & Transformer

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• AI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏±‡∏ä‡∏ô‡∏µ SET ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• LSTM ‡πÄ‡∏õ‡πá‡∏ô Benchmark ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• Transformer

## üõ†Ô∏è Tech Stack & Libraries
- Python 3.x
- Google Colab (for GPU training)
- TensorFlow / Keras
- Pandas & Pandas-TA
- Scikit-learn
- yfinance
- Matplotlib

## üìÇ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå (Project Structure)
Thai-Stock-Prediction-Transformer/
‚îú‚îÄ‚îÄ 01_notebooks/             # ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Jupyter Notebooks
‚îÇ   ‚îú‚îÄ‚îÄ 1_Data_Preparation.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ 2_LSTM_Benchmark_Training.ipynb
‚îÇ   ‚îú‚îÄ‚îÄ 3_Transformer_Upgrade_Training.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ 4_Model_Comparison.ipynb
|   |__ 4.1_SET50_Model_Comparison_Fixed
‚îú‚îÄ‚îÄ 02_data/                  # ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ñ‡∏π‡∏Å gitignore)
‚îú‚îÄ‚îÄ 03_models/                # ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡∏ñ‡∏π‡∏Å gitignore)
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ README.md


## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå (How to Run)
1. Clone repository ‡∏ô‡∏µ‡πâ‡∏•‡∏á‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: `git clone <URL>`
2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `01_notebooks/`
3. ‡∏£‡∏±‡∏ô Notebook ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà `1_...` ‡∏ñ‡∏∂‡∏á `4_...` ‡∏ö‡∏ô Google Colab ‡∏´‡∏£‡∏∑‡∏≠ Jupyter Environment ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
   - Notebook `1_Data_Preparation.ipynb` ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `set50_processed_data.csv` ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `02_data/`
   - Notebooks `2_...` ‡πÅ‡∏•‡∏∞ `3_...` ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏£‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏•‡∏á‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `03_models/`

## üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Results)
‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á, ‡πÇ‡∏°‡πÄ‡∏î‡∏• Transformer 

Model	RMSE (Baht)	MAE (Baht)	Directional Acc.
LSTM (Benchmark)	24.7	20.2	53.5%
Transformer	96.5	68.3	49.5%

RMSE / MAE: LSTM ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ Transformer ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô (~4 ‡πÄ‡∏ó‡πà‡∏≤) ‚Üí LSTM ‡∏ó‡∏≤‡∏¢‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤

Directional Accuracy: LSTM ~53% (‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏≠‡∏¢‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢), Transformer ~49% (‡πÉ‡∏Å‡∏•‡πâ random)

‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡πá‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ß‡πà‡∏≤ Transformer ‚Äú‡∏´‡∏•‡∏∏‡∏î‡πÄ‡∏ó‡∏£‡∏ô‡∏î‡πå‚Äù ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏•‡∏±‡∏á

**‡∏ó‡∏≥‡πÑ‡∏° Transformer ‡πÅ‡∏û‡πâ LSTM ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ?

1. Data size (2392 ‡πÅ‡∏ñ‡∏ß ‚âà 9 ‡∏õ‡∏µ) ‚Üí ‡πÑ‡∏°‡πà‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Transformer ‡∏ó‡∏µ‡πà‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏¢‡∏≠‡∏∞
‚Üí LSTM ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏¢‡∏≠‡∏∞‡πÅ‡∏•‡∏∞ pattern ‡πÑ‡∏°‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏°‡∏≤‡∏Å

2. Hyperparameters ‡∏Ç‡∏≠‡∏á Transformer

ff_dim=128, blocks=3 ‚Üí ‡∏≠‡∏≤‡∏à‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ~15 ‡∏ï‡∏±‡∏ß

‡πÑ‡∏°‡πà‡∏°‡∏µ regularization ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‚Üí ‡πÄ‡∏£‡∏¥‡πà‡∏° overfit ‚Üí ‡∏ú‡∏•‡∏ö‡∏ô test ‡πÅ‡∏¢‡πà

3. Feature set ‚Üí ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á indicator standard (RSI, MACD, BBands)

‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå engineered (returns, rolling stats, volume-based) ‚Üí Transformer ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô

4. Label = ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏¥‡∏î (Close) ‚Üí ‡∏°‡∏µ non-stationary ‡∏™‡∏π‡∏á

LSTM ‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡∏•‡∏∞‡∏™‡πÄ‡∏ï‡πá‡∏õ

Transformer ‡∏°‡∏±‡∏Å‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö sequence ‡∏¢‡∏≤‡∏ß‡πÜ + stationary (‡πÄ‡∏ä‡πà‡∏ô return series)

**‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢:**

![Prediction Result](https://drive.google.com/file/d/16oUPDAkN_14dWJ_2lEpE70dGcP8h8-QQ/view?usp=drive_link)


## üîÆ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠ (Future Work)
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Sentiment Analysis ‡∏à‡∏≤‡∏Å‡∏Ç‡πà‡∏≤‡∏ß‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Feature
- ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏¢‡∏ï‡∏±‡∏ß
- ‡∏ô‡∏≥‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô Dashboard ‡∏î‡πâ‡∏ß‡∏¢ Streamlit
